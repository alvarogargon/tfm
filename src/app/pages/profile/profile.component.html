<section class="profile-container py-5">
  <div class="container">
    <div class="row g-4">

      <!-- Left Sidebar -->
      <div class="col-md-4 col-lg-3 mb-4 sidebar">
        <div class="profile">
          <div class="profile-avatar-wrapper position-relative">
            <img [src]="'http://localhost:3000' + user?.image || 'https://i.pinimg.com/736x/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg'" 
            alt="Profile" 
            class="profile-avatar mb-3"
            (click)="onAvatarClick()"
            style="cursor: pointer;">
            <input type="file"
            #fileInput
            accept="image/png, image/jpeg, image/jpg"
            style="display: none;"
            (change)="onFileSelected($event)">
            <button class="editBtn" (click)="onAvatarClick()" title="Cambiar foto">
              <svg height="1em" viewBox="0 0 512 512">
                <path
                  d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"
                ></path>
              </svg>
            </button>
          </div>
          @if (!showEditForm) {
          <h2 class="mb-1">{{ user?.username || 'Nombre de Usuario' }}</h2>
          <p class="text-muted mb-0">{{ user?.email || 'usuario&#64;email.com' }}</p>
          <button class="button btn-sm mb-3" (click)="showEditForm = true">Editar Perfil</button>
          }
          <!-- Edit Profile Form -->
          @if(showEditForm) {
            <app-edit-profile (close)="showEditForm = false"></app-edit-profile>
          } @else {
          <div class="mb-3">
            <span class="badge bg-purple">PRO</span>
          </div>
          <div>
            <h6 class="text-muted mb-1">Highlights</h6>
            <ul class="list-unstyled mb-0 highlights">
              <li><span class="badge bg-secondary">Productividad</span></li>
              <li><span class="badge bg-secondary">Videojuegos</span></li>
              <li><span class="badge bg-secondary">Jardinería</span></li>
              <li><span class="badge bg-secondary">Lectura</span></li>
              <li><span class="badge bg-secondary">Música</span></li>
            </ul>
          </div>
          }
        </div>
      </div>

      <!-- Main Content -->
      <div class="col-md-8 col-lg-9 main-content">

        <!-- Stats -->
        <div class="stats">
          <div class="card shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title mb-2">Rutinas activas</h5>
              <span class="display-6 fw-bold text-primary">4</span>
            </div>
          </div>
          <div class="card shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title mb-2">Hábitos completados</h5>
              <span class="display-6 fw-bold text-success">23</span>
            </div>
          </div>
          <div class="card shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title mb-2">Racha actual</h5>
              <span class="display-6 fw-bold text-warning">7 días</span>
            </div>
          </div>
        </div>
        
        <!-- Motivational Quote -->
        <blockquote class="blockquote text-center">
          <p class="mb-0">"El progreso no es lineal, pero cada paso cuenta."</p>
          <footer class="blockquote-footer pt-3">Recuerda celebrar tus logros</footer>
        </blockquote>
      
        <!-- Recent Activity -->
        <div class="recent-activity">
          <h4>Actividad reciente</h4>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">✔️ Completaste la rutina "Mañana productiva"</li>
            <li class="list-group-item">✔️ Nuevo hábito añadido: "Leer 10 minutos"</li>
            <li class="list-group-item">✔️ Racha de 7 días alcanzada</li>
          </ul>
        </div>

        <!-- Routines -->
        <div>
          <h4>Rutinas</h4>
          <div class="card shadow-sm mb-3">
            <div class="card-body">
              <h5 class="card-title">Rutina de Mañana</h5>
              <p class="card-text">Incluye meditación, ejercicio y planificación del día.</p>
              <button class="button">Ver Detalles</button>
            </div>
          </div>
          <div class="card shadow-sm mb-3">
            <div class="card-body">
              <h5 class="card-title">Tarde productiva</h5>
              <p class="card-text">Música y tareas enfocadas.</p>
              <button class="button">Ver Detalles</button>
            </div>
          </div>
          <div class="card shadow-sm mb-3">
            <div class="card-body">
              <h5 class="card-title">Mañana creativa</h5>
              <p class="card-text">Fotografía y cocina.</p>
              <button class="button">Ver Detalles</button>
            </div>
          </div>
          <div class="card shadow-sm mb-3">
            <div class="card-body">
              <h5 class="card-title">Rutina de ejercicio</h5>
              <p class="card-text">Entrenamiento y relajación.</p>
              <button class="button">Ver Detalles</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>